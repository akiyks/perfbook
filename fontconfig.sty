% font configs for perfbook
% not implemented as a proper LaTeX style file
% suppoesed to be included by \input{} in the preamble

\usepackage{iftex}

\newboolean{opentypefont}
\setboolean{opentypefont}{false}
\ifPDFTeX
  \usepackage[T1]{fontenc} % use postscript type 1 fonts
\else % LuaTeX or XeTeX
  \ifthenelse{\boolean{sansserif} \or \boolean{msdefault}}{
    \setboolean{opentypefont}{true}}{}
\fi

\newboolean{unicodemathloaded}
\setboolean{unicodemathloaded}{false}

\ifthenelse{\boolean{opentypefont}}{ % fontspec ready font choices
  \ifthenelse{\boolean{sansserif}}{ % TeX Gyre Heros base setting
    \usepackage{textcomp} % use symbols in TS1 encoding
    \renewcommand{\familydefault}{\sfdefault}
    \normalfont
    \usepackage[slantedGreek,scaled=.96]{newtxsf} % type1 font package
    \usepackage[no-math]{fontspec} % No math
    \setromanfont{TeX Gyre Termes}
    \setsansfont{TeX Gyre Heros}[Scale=.89,WordSpace=1.05]
    \setmainfont{TeX Gyre Heros}[Scale=.89,WordSpace=1.05]
    \setmonofont{Inconsolatazi4}[Scale=MatchUppercase,StylisticSet=2]
    \setboolean{nimbusavail}{false}
    \usepackage{bm} % need bm for newtxsf (type1 math font)
    \providecommand{\symbf}[1]{\bm{#1}} % fall back to \bm for type1 math fonts
  }{}
  \ifthenelse{\boolean{msdefault}}{ % TeX Gyre Termes (Times clone) based
				    % full opentype setting
    \usepackage{unicode-math}
    \setboolean{unicodemathloaded}{true}
    \setmainfont{TeX Gyre Termes}[WordSpace=1.115,Scale=.99]
    % "TeX Gyre Termes Math" has peculiar looking kernning around "f".
    % Use STIX Two Math as an alternative.
    \setmathfont{STIX Two Math}[math-style=ISO,Scale=MatchUppercase,BoldFont={XITSMath-Bold}]
    \setsansfont{TeX Gyre Heros}[Scale=MatchUppercase,WordSpace=1.05]
    \setmonofont{LMMono10-Regular}[Scale=.97,BoldFont={LMMonoLt10-Bold}]
    \setboolean{nimbusavail}{false}
  }{}
  % Restore even spacing ellipsis in text (math mode ellipsis still uneven)
  \UndeclareTextCommand{\textellipsis}{TU}
}{ % font choices incompatible with fontspec + opentype fonts
\ifPDFTeX
  \usepackage[defaultsups,helvratio=0.9]{newtxtext} % use nice, standard fonts for roman
\else % LuaTeX or XeTeX
  \ifthenelse{\boolean{newtxoneseven}}{ % newtx 1.7 or later needs nofontspec
                                        % for existing font choices.
    \usepackage[nofontspec,defaultsups,helvratio=0.9]{newtxtext}
  }{
    \usepackage[defaultsups,helvratio=0.9]{newtxtext}
  }
\fi

\IfSansSerif{
\renewcommand{\familydefault}{\sfdefault}
\normalfont
\usepackage[slantedGreek,scaled=.96]{newtxsf}
}{
\usepackage[slantedGreek,varvw]{newtxmath} % math package to be used with newtxtext
% Poor person's slanted shape for roman --- newtxtext lacks slanted shape
\AtBeginDocument{%
  \DeclareFontShape{\encodingdefault}{\rmdefault}{m}{sl}{<-> ptmro7t}{}%
  \DeclareFontShape{\encodingdefault}{\rmdefault}{b}{sl}{<-> ptmbo7t}{}%
  \DeclareFontShape{\encodingdefault}{\rmdefault}{bx}{sl}{<->ssub * ptm/b/sl}{}%
}
}

\IfNimbusAvail{
\usepackage{nimbusmononarrow}
}{}
\ifthenelse{\boolean{msdefault}}{
  \renewcommand*\ttdefault{lmtt}}{}
\ifthenelse{\boolean{msnt}}{
  \usepackage[zerostyle=a]{newtxtt}}{}
\ifthenelse{\boolean{mstx}}{
  \renewcommand*\ttdefault{txtt}}{}
\ifthenelse{\boolean{mss}}{
  \usepackage[scaled=.94]{couriers}}{}
\ifthenelse{\boolean{msr}}{
  \usepackage[scaled=.94]{nimbusmono}}{}
\ifthenelse{\boolean{msn}}{}{}
\ifthenelse{\boolean{msns}}{
  \usepackage{courier}}{}
\IfSansSerif{
  \usepackage[var0]{inconsolata}[2013/07/17]}{}

\usepackage{bm} % for bold math mode fonts --- should be after math mode font choice
\providecommand{\symbf}[1]{\bm{#1}} % fall back to \bm for type1 math fonts
}
